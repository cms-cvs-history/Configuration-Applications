process CalTowerMaker = {

  source = PoolSource { 
    untracked vstring fileNames = {"file:reco-application-calorimetry-reconstruction.root"}
    untracked int32 maxEvents = -1
  }

  module out = PoolOutputModule {
    untracked string fileName = "reco-application-calorimetry-caltowers.root"
    untracked vstring outputCommands = {
      "keep *",
      # drop digis
      "drop *_ecalrechit_*_*",
      "drop *_esrechit_*_*",
      "drop *_ecaluncalibrechit_*_*",
      "drop *_hbhereco_*_*",
      "drop *_horeco_*_*",
      "drop *_hfreco_*_*"
    }
  }

  # initialize  MessageLogger
  include "FWCore/MessageLogger/data/MessageLogger.cfi"
  replace MessageLogger.fwkJobReports = {"reco-application-calorimetry-caltowers.log.xml"}

        # CMS Geometry
  include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"
  # Calo geometry/topology services
  include "Geometry/CaloEventSetup/data/CaloGeometry.cfi"

  #include "Geometry/CaloEventSetup/data/CaloTowerConstituents.cfi"
  es_module = CaloTowerConstituentsMapBuilder {
      untracked string MapFile="Geometry/CaloTopology/data/CaloTowerEEGeometric.map.gz"
  }

  include "Geometry/CaloEventSetup/data/CaloTopology.cfi"
  es_module = HcalTopologyIdealEP {}
 
  include "RecoJets/JetProducers/data/CaloTowerSchemeB.cfi"
  replace calotowermaker.hbheInput = "hbhereco"
  replace calotowermaker.hoInput = "horeco"
  replace calotowermaker.hfInput = "hfreco"
  replace calotowermaker.AllowMissingInputs = false
  replace calotowermaker.ecalInputs = {"ecalrechit/EcalRecHitsEB"}

#  include "RecoLocalCalo/CaloTowersCreator/data/calocandidatemaker.cfi"
 module caloTowers = CaloTowerCandidateCreator {
          string src = 'calotowermaker'
          double minimumEt = -1
          double minimumE = -1
  }
 
  path p = { calotowermaker, caloTowers }

  endpath e = 
  {
    out
  }
}
