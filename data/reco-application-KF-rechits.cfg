process ClusterNRecHits = 
{
  ### keep the logging output to a nice level ###
  include "FWCore/MessageLogger/data/MessageLogger.cfi"

  ### initialize magnetic field
  include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"


  ############### initialize geometry #####################
  es_source = XMLIdealGeometryESSource 
  { 
    # tracker geometry
    FileInPath GeometryConfiguration = "Geometry/TrackerSimData/data/trackerSimConfiguration.xml"

    # full simulation geometry
    #FileInPath GeometryConfiguration = "Geometry/CMSCommonData/data/SimConfiguration.xml"

    # the proper root node is set in the xml file
    string rootNodeName = ""
  }
		
  ### tracker geometry
  include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"

  ### tracker numbering
  include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"


  source = PoolSource 
  { 
    untracked vstring fileNames = {'file:KFdigis.root'}
    untracked int32 maxEvents = -1
  }

  # include StripCPEfromTrackAngleESProducer es_module
  include "RecoLocalTracker/SiStripRecHitConverter/data/StripCPEfromTrackAngle.cfi"


########################################################################
#
# Run Pixel Clusterizer and RecHit producer in chain
#

  #include  pixClust
  include "RecoLocalTracker/SiPixelClusterizer/data/SiPixelClusterizer.cfi"

  #include pixRecHitConverter
  include "RecoLocalTracker/SiPixelRecHits/data/SiPixelRecHits.cfi" 

########################################################################


########################################################
# Run SiStrip Clusterizer and RecHit producer in chain
  # include SiStripClusterizer
  include "RecoLocalTracker/SiStripClusterizer/data/SiStripClusterizer.cfi"

  #include LocalMeasurementConverter module	
  include "RecoLocalTracker/SiStripRecHitConverter/data/SiStripRecHitConverter.cfi"	
###########################################################



  module AsciiOutput = AsciiOutputModule {}

  module out = PoolOutputModule 
  {
    untracked string fileName = 'KFhits.root'
  }

  path p = 
  {
    pixClust,pixRecHitConverter, ThreeThresholdClusterizer,LocalMeasurementConverter
  }

  endpath e = 
  {
    AsciiOutput, out
  }
}
