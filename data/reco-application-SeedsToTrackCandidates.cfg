process PatternRecognition = 
{

  # initialize  MessageLogger
  include "FWCore/MessageLogger/data/MessageLogger.cfi"
 
  # initialize magnetic field
  include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

  # geometry (switched to tracker only geometry)
  # include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"
  es_source = XMLIdealGeometryESSource 
  {
    FileInPath GeometryConfiguration="Geometry/TrackerSimData/data/trackerSimConfiguration.xml"
    string rootNodeName = ""
  }

  # tracker geometry
  include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"

  # tracker numbering
  include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"

  # tracker reco geometry 
  es_module = TrackerRecoGeometryESProducer {}

  # roads             
  include "RecoTracker/RoadMapESSource/data/RoadMapESSource.cfi"

  es_module = KFUpdatorESProducer
  {
    string ComponentName = "KFUpdator"   
  }

  es_module = Chi2MeasurementEstimatorESProducer
  {
    string ComponentName = "Chi2"   
    double MaxChi2 = 30. 
    double nSigma = 3.
  }

  es_module mat1 = PropagatorWithMaterialESProducer {
    string ComponentName = "PropagatorWithMaterial"
    string PropagationDirection = "alongMomentum"	
    double Mass = 0.105
  }

  es_module mat2 = PropagatorWithMaterialESProducer {
    string ComponentName = "PropagatorWithMaterialOpposite"
    string PropagationDirection = "oppositeToMomentum"	
    double Mass = 0.105
  }

  source = PoolSource 
  { 
    untracked vstring fileNames = {"file:HitsToSeeds.root"}
    untracked int32 maxEvents = -1
  }

  # KfTrackCandidateMaker
  include "RecoTracker/CkfPattern/data/CombinatorialTrajectoryBuilder.cfi"

  # RoadSearchCloudMaker
  include "RecoTracker/RoadSearchCloudMaker/data/RawRoadSearchClouds.cfi"

  # RoadSearchCloudMaker
  include "RecoTracker/RoadSearchCloudCleaner/data/CleanRoadSearchClouds.cfi"

  # RoadSearchTrackCandidateMaker
  include "RecoTracker/RoadSearchTrackCandidateMaker/data/RoadSearchTrackCandidates.cfi"


  module out = PoolOutputModule 
  {
    untracked string fileName = "SeedsToTrackCandidates.root"
  }

  path p = 
  {
    trackCandidateMaker,
    RawRoadSearchClouds,
    CleanRoadSearchClouds,
    RoadSearchTrackCandidates
  }

  endpath e = 
  {
    out
  }
}
