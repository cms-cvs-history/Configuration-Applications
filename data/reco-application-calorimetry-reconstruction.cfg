process Reconstruction = {

  source = PoolSource { 
    untracked vstring fileNames = {"file:reco-application-calorimetry-digitization.root"}
    untracked int32 maxEvents = -1
  }

  module out = PoolOutputModule {
    untracked string fileName = "reco-application-calorimetry-reconstruction.root"
    untracked vstring outputCommands = {
      "keep *",
      # drop CaloHits
      "drop *_hcaldigi_*_*",
      "drop *_ecaldigi_*_*"
    }
  }

  # initialize  MessageLogger
  include "FWCore/MessageLogger/data/MessageLogger.cfi"
  replace MessageLogger.fwkJobReports = {"reco-application-calorimetry-reconstruction.log.xml"}
 
  # calo geometry
  include "Geometry/CaloEventSetup/data/CaloGeometry.cfi"

  #calibrations
  es_source = EcalTrivialConditionRetriever {}
  include "CalibCalorimetry/HcalPlugins/data/hardwired_conditions.cfi"

  # ECAL reconstruction
  include "RecoLocalCalo/EcalRecProducers/data/EcalWeightUncalibratedRecHitProducer.cfi"
  include "RecoLocalCalo/EcalRecProducers/data/EcalRecHitProducer.cfi"
  include "RecoLocalCalo/EcalRecProducers/data/ESRecHitProducer.cfi"

  #HCAL reconstruction
  include "RecoLocalCalo/HcalRecProducers/data/HcalSimpleReconstructor-hbhe.cfi"
  include "RecoLocalCalo/HcalRecProducers/data/HcalSimpleReconstructor-ho.cfi"
  include "RecoLocalCalo/HcalRecProducers/data/HcalSimpleReconstructor-hf.cfi"
  replace hfreco.firstSample = 3
  replace hfreco.samplesToAdd = 1
  replace hfreco.correctForTimeslew = false
                                                 
#  path p = { ecaluncalibrechit & ecalrechit & esrechit & hbhereco & hfreco & horeco }
  path p = { ecaluncalibrechit & ecalrechit & esrechit & hbhereco & horeco }

  endpath e = 
  {
    out
  }
}
