process Digitization = {

  source = PoolSource { 
    untracked vstring fileNames = {"file:reco-application-calorimetry-simulation.root"}
    untracked int32 maxEvents = -1
  }

  module out = PoolOutputModule {
    untracked string fileName = "reco-application-calorimetry-digitization.root"
    untracked vstring outputCommands = {
      "keep *",
      # drop mixer information
      "drop *_mix_*_*",
      # drop G4 objects
      "drop *_SimG4Object_*_*"
    }
  }

  # initialize  MessageLogger
  include "FWCore/MessageLogger/data/MessageLogger.cfi"
  replace MessageLogger.fwkJobReports = {"reco-application-calorimetry-digitization.log.xml"}
 
  # mixing is required for digitization
  module mix = MixingModule {      
    int32 bunchspace = 25
  }

  # initialize magnetic field
  include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

  # geometry (Only Ecal+Hcal geometry)
  include "Geometry/CaloEventSetup/test/data/testCaloConfiguration.cfi"

  # Calo geometry service model
  include "Geometry/CaloEventSetup/data/CaloGeometry.cfi"

  # ECAL calibrations 
  es_source = EcalTrivialConditionRetriever { }

  # HCAL calibrations
  include "CalibCalorimetry/HcalPlugins/data/hardwired_conditions.cfi"

  #Full digitization (EB+EE+ES)
  include "SimCalorimetry/EcalSimProducers/data/ecaldigi.cfi"

  # hcal digitization
  include "SimCalorimetry/HcalSimProducers/data/hcaldigi.cfi"
                                                 
  path p = { mix, ecaldigi & hcaldigi }

  endpath e = { out }
}
